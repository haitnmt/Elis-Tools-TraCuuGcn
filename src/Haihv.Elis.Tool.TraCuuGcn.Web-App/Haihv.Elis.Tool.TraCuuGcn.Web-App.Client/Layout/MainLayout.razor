@inherits LayoutComponentBase
@attribute [StreamRendering]
@using Haihv.Elis.Tool.TraCuuGcn.WebLib.Components
@* Required *@
<MudThemeProvider/>
<MudPopoverProvider/>
@* Needed for dialogs *@
<MudDialogProvider/>

@* Needed for snackbars *@
<MudSnackbarProvider/>

<StorageSyncInitializer/>

<MudThemeProvider @ref="@_mudThemeProvider" @bind-IsDarkMode="@_isDarkMode"/>
@if (_isInitialized)
{
    <MudLayout>
        <MudAppBar>
            <MudAvatar Class="mr-2">
                <MudImage Src="./logo.png"></MudImage>
            </MudAvatar>
            <MudHidden Breakpoint="Breakpoint.SmAndDown">
                <MudText Typo="Typo.h6">
                    Tra c·ª©u th√¥ng tin Gi·∫•y ch·ª©ng nh·∫≠n
                </MudText>
            </MudHidden>
            <MudHidden Breakpoint="Breakpoint.MdAndUp">
                <MudStack Spacing="0">
                    <MudText Typo="Typo.subtitle2">
                        Tra c·ª©u th√¥ng tin
                    </MudText>
                    <MudText Typo="Typo.subtitle2">
                        Gi·∫•y ch·ª©ng nh·∫≠n
                    </MudText>
                </MudStack>
            </MudHidden>
            <MudSpacer/>
            <MudHidden Breakpoint="Breakpoint.SmAndDown">
                @if (string.IsNullOrWhiteSpace(_displayName))
                {
                    <MudButton
                        Color="Color.Inherit"
                        OnClick="OpenDangNhap">
                        <MudText Typo="Typo.body2">
                            ƒêƒÉng nh·∫≠p
                        </MudText>
                    </MudButton>
                }
                else
                {
                    <MudStack Row="true">
                        <MudText>
                            Xin ch√†o, @_displayName
                        </MudText>
                    </MudStack>
                    <MudTooltip Text="ƒêƒÉng xu·∫•t">
                        <MudIconButton
                            Icon="@Icons.Material.Filled.Logout"
                            Size="Size.Small"
                            Color="Color.Inherit"
                            OnClick="Logout"/>
                    </MudTooltip>
                }
            </MudHidden>
            <MudHidden Breakpoint="Breakpoint.MdAndUp">
                <MudTooltip
                    Text="@(string.IsNullOrWhiteSpace(_displayName) ? "ƒêƒÉng nh·∫≠p" : $"Xin ch√†o, {_displayName}! Click ƒë·ªÉ ƒëƒÉng xu·∫•t")">
                    <ChildContent>
                        <MudIconButton Icon="@Icons.Material.Filled.Person"
                                       Size="Size.Small"
                                       OnClick="@(string.IsNullOrWhiteSpace(_displayName) ? OpenDangNhap : Logout)"></MudIconButton>
                    </ChildContent>
                    <TooltipContent>
                        @if (string.IsNullOrWhiteSpace(_displayName))
                        {
                            <MudText Typo="Typo.body2">ƒêƒÉng nh·∫≠p</MudText>
                        }
                        else
                        {
                            <MudText Typo="Typo.body2">Xin ch√†o, @_displayName!</MudText>
                            <MudText Typo="Typo.body2">Click ƒë·ªÉ ƒëƒÉng xu·∫•t!</MudText>
                        }
                    </TooltipContent>
                </MudTooltip>
            </MudHidden>
            <MudToggleIconButton @bind-Toggled="@_isDarkMode"
                                 Icon="@Icons.Material.Filled.DarkMode"
                                 Color="@Color.Error"
                                 Size="Size.Small"
                                 title=@(_isDarkMode ? "On" : "Off")
                                 ToggledIcon="@Icons.Material.Filled.LightMode" ToggledColor="@Color.Default"/>
            <MudIconButton
                Icon="@Icons.Custom.Brands.GitHub"
                Size="Size.Small"
                Color="Color.Inherit"
                Href="@UrlGitHub"
                Target="_blank"/>
        </MudAppBar>
        <MudMainContent>
            @Body
        </MudMainContent>
        <MudAppBar Bottom="true" Dense="true" Color="Color.Dark">
            <MudText Typo="Typo.caption">
                ¬© @(DateTime.Today.Year) vpdkbacninh.vn | haihv.vn
            </MudText>
            <MudSpacer/>
            <MudStack Row="true" AlignItems="AlignItems.Center">
                <MudHidden Breakpoint="Breakpoint.SmAndDown">
                    <Version/>
                </MudHidden>
                <About/>
            </MudStack>
        </MudAppBar>
    </MudLayout>
}
else
{
    <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" Style="height: 100vh">
        <MudProgressCircular Color="Color.Primary" Size="Size.Medium" Indeterminate="true"/>
        <MudAlert Severity="Severity.Info" Dense="true">
            <MudText Typo="Typo.body2">ƒêang kh·ªüi t·∫°o...</MudText>
        </MudAlert>
    </MudStack>
}
<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">üóô</span>
</div>

